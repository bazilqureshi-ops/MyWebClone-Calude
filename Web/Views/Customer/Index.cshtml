@using Emse.QMagic.Web.Models;
@{
	List<qmCustomer> customers = ViewBag.model;
}




<div class="row">
	<div class="col-xs-12 col-md-12">
		<div class="card">
			<div class="card-header">
				Customer List
			</div>
			<div class="card-body no-padding">
				<table class="datatable table table-striped primary" cellspacing="0" width="100%">
					<thead>
						<tr>
							<th>UniqueID</th>
							<th>Name</th>
							<th>Surname</th>
							<th>E-mail</th>
							<th>Phone</th>
							<th>Device Type</th>
							<th>Action</th>
						</tr>
					</thead>
					<tbody>
						@{
							if (customers.Count > 0)
							{
								foreach (var item in customers)
								{
									<tr>
										<td>@item.UniqueID</td>
										<td>@item.Name</td>
										<td>@item.Surname</td>
										<td>@item.EMail</td>
										<td>@item.Phone</td>
										<td>
											@{
												if (!string.IsNullOrEmpty(item.DeviceToken2))
												{
													<i class="fa fa-mobile-phone"></i>
												}
											}
										</td>
                                        <td width="200">
                                            <a href="../Customer/EditCustomer?id=@item.CustomerID" class="btn btn-default"><span class="fa fa-pencil"></span></a>
                                            <a href="javascript:DeleteRecord(@item.CustomerID);" class="btn btn-danger"><span class="fa fa-remove"></span></a>
                                        </td>
									</tr>
								}
							}
						}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<div class="btn-floating" id="help-actions">
	<div class="btn-bg"></div>
	<button type="button" class="btn btn-default btn-toggle" data-toggle="toggle" data-target="#help-actions">
		<i class="icon fa fa-plus"></i>
		<span class="help-text">Shortcut</span>
	</button>
	<div class="toggle-content">
		<ul class="actions">
			<li><a href="~/Customer/CreateCustomer">Create a New Customer</a></li>
		</ul>
	</div>
</div>

<link href="~/assets/css/sweetalert2.min.css" rel="stylesheet" />
<script src="~/assets/js/sweetalert2.all.min.js"></script>

<script>
	function DeleteRecord(recordid) {
		swal({
				title: "Are you sure to delete this customer?",
				text: "If you delete the customer, you will not able to reach this customer information.",
				icon: "warning",
				buttons: true,
				dangerMode: true,
			})
			.then((willDelete) => {
				if (willDelete) {
					$.ajax({
						type: "POST",
						url: "/Customer/DeleteCustomer",
						dataType: "json",
						data: "ID=" + recordid,
						success: function (result) {
							window.location = "/Customer";
						}
					});
				}
				else {
					swal({
						title: "Canceled",
						icon: "info",
					});
				}
			});
	}
</script>